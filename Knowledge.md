# Tasks - Задачи
Это бесконечная функция, содержащая какой-то код внутри себя. Имеет свой объём памяти на стэке и приоритет. Может быть в 4 состояниях:
- Готова к выполнению 
- - Задача готова, но не выполняется, так как другая таска с большим приоритетом или равным выполняется.
- Заблокирована
- - Задача ожидает временного и внешнего события.
- Приостановлена
- - Задача не доступна для запланированного выполнения, но хранится в памяти.
- Выполняется
- - Таска выполняется в текущий момент (Может выполняться только одна задача.)
Данная функция ничего не возвращает, т.е. не содержит return. 

Конечный автомат того как работает задача (таска):
<p align="center">
  <img src=./data/sm_task.png />
</p>

### Пример создания задачи
```
    osThreadDef(Task1(Имя задачи для хендлера), StartTask1(Имя функции), osPriorityNormal, Number_of_instances, Stack_size_in_bytes);
    Task1Handle = osThreadCreate(osThread(Task1), NULL(Аргумент в функцию))  
    - - Возвращает значения:
    - - - NULL -> ошибка
    - - - !NULL -> индентификатор задачи
```




Таска состоит:
-  Кода  
- Памяти выделенной 
- Блок контроля таски (Содержит информацию о задачи, включая указатель на функцию, приоритет, текущее состоянии. Можно назвать сервисным блоком)

Пример такси:
```
void SampleTask(void const * argument)
{
    // Блок инициализации задачи

    //Завершение инициализации

    for(;;){
        /* Код задачи, который будет выполнять в режиме выполнения.*/
    }

    // Сюда код никогда не должен попасть
}
```
Если нужно остановить задачу, её можно удалить или перевести в режим "Приостановлена".

## Приоритеты
Определяются числом от 0(низший приоритет) до максимальный - 1. 
! Примечание. Максимальный приоритет определяется в файле FreeRTOSConfig.h
Приоритеты могут изменяться для задач во время выполнения. Приоритет таски можно временно увеличить или уменьшить.
<p align="center">
  <img src=./data/priorities.png />
</p>

## Указатели стека
1. Основной указатель отвечает за работу ядра ОС и внешние прерывания. Располагается линковщиком при компиляции
2. Указатель стека процесса - инициализируется для каждой задачи отдельно. Работает внутри одной задачи.

# Intertask communication - Взаиммодействие между задачами
## Queues - Очереди
Это канал свзяи для передачи данными между задачами. Ведёт себя как FIFO (First in, First Out). Данные передаваемые через очереди должны быть одного и того же типа данных.
Размер очереди указывается при инициализации: кол-во элементов * размер элемента в байтах.